<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elastic Collision Brownian Motion</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <header>
        <h1>Elastic Collision Brownian Motion Simulation</h1>
        <p>Demonstrating Brownian motion through elastic collisions between one large particle and many small particles</p>
    </header>

    <main>
        <div class="simulation-container">
            <div class="simulation-panel">
                <canvas id="simulation-canvas"></canvas>
                <div class="simulation-controls">
                    <div class="button-row">
                        <button id="reset-btn">Reset Simulation</button>
                        <button id="pause-btn">Pause</button>
                        <button id="reset-msd-btn">Reset MSD</button>
                    </div>
                    <div class="controls-row">
                        <div class="particle-count-control">
                            <label for="particle-count">Small Particles:</label>
                            <input type="range" id="particle-count" min="1500" max="4000" value="2500" step="250">
                            <span id="particle-count-value">2500</span>
                        </div>
                        <div class="particle-count-control">
                            <label for="particle-speed">Speed:</label>
                            <input type="range" id="particle-speed" min="0.2" max="2.0" value="0.5" step="0.1">
                            <span id="particle-speed-value">0.5</span>
                        </div>
                        <div class="particle-count-control">
                            <label for="world-size">Field Size:</label>
                            <input type="range" id="world-size" min="200" max="600" value="200" step="50">
                            <span id="world-size-value">200</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="analysis-panel">
                <div class="stats-section">
                    <h3>Real-time Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <label>Time Steps:</label>
                            <span id="ticks-value">0</span>
                        </div>
                        <div class="stat-item">
                            <label>Current MSD:</label>
                            <span id="msd-value">0.00</span>
                        </div>
                        <div class="stat-item">
                            <label>Collisions:</label>
                            <span id="collision-count">0</span>
                        </div>
                        <div class="stat-item">
                            <label>Large Particle Speed:</label>
                            <span id="velocity-value">0.00</span>
                        </div>
                        <div class="stat-item">
                            <label>Total Displacement:</label>
                            <span id="displacement-value">0.00</span>
                        </div>
                        <div class="stat-item">
                            <label>Brownian Motion:</label>
                            <span id="brownian-indicator">Initializing...</span>
                        </div>
                    </div>
                    
                    <h4>Langevin Diagnostics</h4>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <label>Diffusion Coeff (D):</label>
                            <span id="diffusion-coeff">0.00</span>
                        </div>
                        <div class="stat-item">
                            <label>Expected D:</label>
                            <span id="theoretical-diffusion">0.50</span>
                        </div>
                        <div class="stat-item">
                            <label>Equipartition ⟨v²⟩:</label>
                            <span id="equipartition-value">0.00</span>
                        </div>
                        <div class="stat-item">
                            <label>Expected ⟨v²⟩:</label>
                            <span id="theoretical-equipartition">0.030</span>
                        </div>
                        <div class="stat-item">
                            <label>Velocity τ (ticks):</label>
                            <span id="velocity-decay-time">0</span>
                        </div>
                        <div class="stat-item">
                            <label>Expected τ:</label>
                            <span id="theoretical-decay-time">16.7</span>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <h3>Mean Squared Displacement</h3>
                    <div class="chart-container">
                        <canvas id="msd-chart"></canvas>
                    </div>
                </div>

                <div class="chart-section">
                    <h3>Velocity Autocorrelation</h3>
                    <div class="chart-container">
                        <canvas id="velocity-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <details>
                <summary>Simulation Details</summary>
                <div class="info-content">
                    <h4>Physics Model</h4>
                    <ul>
                        <li><strong>Large Particle:</strong> Mass = 50, Radius = 12, Initially at rest</li>
                        <li><strong>Small Particles:</strong> Mass = 1, Radius = 1, Random thermal motion</li>
                        <li><strong>Collisions:</strong> Fully elastic with momentum and energy conservation</li>
                        <li><strong>Langevin Dynamics:</strong> Friction γ = 3.0, Thermal energy kT = 1.5</li>
                        <li><strong>Boundary:</strong> Elastic reflection at walls</li>
                    </ul>
                    <h4>Dynamic Expected Values</h4>
                    <ul>
                        <li><strong>Expected D:</strong> Calculated from effective temperature and friction based on particle density, speed, and world size</li>
                        <li><strong>Expected ⟨v²⟩:</strong> Effective thermal equilibrium from bombardment intensity</li>
                        <li><strong>Expected τ:</strong> Correlation time with boundary corrections for confined system</li>
                        <li><strong>Real-time Updates:</strong> Expected values change when you adjust sliders to reflect system behavior</li>
                    </ul>

                    <h4>Expected Behavior</h4>
                    <p>The large red particle starts at rest. Small blue particles undergo random thermal motion and collide elastically with the large particle, transferring momentum. Over time, the cumulative effect of these random collisions should cause the large particle to exhibit characteristic Brownian motion - erratic, continuous movement with no preferred direction.</p>
                </div>
            </details>
        </div>
    </main>

    <script type="module" src="./index.ts"></script>
</body>
</html>